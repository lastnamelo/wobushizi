(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7697:function(e,t,n){Promise.resolve().then(n.bind(n,9209))},9209:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var l=n(7437),a=n(2265),s=n(4560),r=n(5995),o=n(4798),c=n(6442),i=n(5696);let d=RegExp("\\p{Script=Han}","u"),u=(0,a.memo)(function(e){let{text:t,selected:n,known:a,onToggle:s}=e;return(0,l.jsx)("div",{className:"rounded-2xl border border-line bg-white p-5 shadow-card",children:(0,l.jsx)("div",{className:"whitespace-pre-wrap leading-9",children:[...t].map((e,t)=>{var r;if(!d.test(e))return(0,l.jsx)("span",{children:e},"".concat(e,"-").concat(t));let o=(0,c.V$)(e),u=(0,i.eS)(null!==(r=null==o?void 0:o.hsk_level)&&void 0!==r?r:null),h=a.has(e),x=n.has(e),m="string"==typeof(null==o?void 0:o.pinyin)?o.pinyin:"";return(0,l.jsx)("span",{onClick:()=>s(e),className:"inline-block rounded px-0.5 text-2xl transition cursor-pointer ".concat(x?"bg-slate-200":"bg-transparent hover:bg-slate-100"),style:{color:u},title:m||(h?"Previously known":"No pinyin"),children:e},"".concat(e,"-").concat(t))})})})});var h=n(4807),x=n(9733);let m=(()=>{let e={1:0,2:0,3:0,4:0,5:0,6:0,unknown:0};for(let t of(0,c.tk)()){let n="number"==typeof t.hsk_level?t.hsk_level:null;n&&n>=1&&n<=6?e[n]+=1:e.unknown+=1}return e})();function p(e){let t=(0,c.V$)(e);return{character:(null==t?void 0:t.character)?String(t.character):e,traditional_character:(null==t?void 0:t.traditional_character)&&t.traditional_character!==e?String(t.traditional_character):"",alternate_characters:"string"==typeof(null==t?void 0:t.alternate_characters)?t.alternate_characters:"",pinyin:(null==t?void 0:t.pinyin)?String(t.pinyin):"",hsk_level:"number"==typeof(null==t?void 0:t.hsk_level)?t.hsk_level:null,frequency:"number"==typeof(null==t?void 0:t.frequency)?t.frequency:null,definition:(null==t?void 0:t.definition)?String(t.definition):""}}function f(){let[e,t]=(0,a.useState)(!0),[n,i]=(0,a.useState)(0),[m,f]=(0,a.useState)(""),[w,g]=(0,a.useState)("input"),[j,y]=(0,a.useState)(new Set),[N,k]=(0,a.useState)([]),[S,_]=(0,a.useState)(new Set),[C,K]=(0,a.useState)(!1),[H,q]=(0,a.useState)(null),[L,E]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{await (0,x.if)(),i(await (0,x.B9)()),t(!1)})().catch(e=>{q(e.message),t(!1)})},[]);let B=(0,a.useMemo)(()=>S.size,[S]),F=(0,a.useMemo)(()=>{let e={1:0,2:0,3:0,4:0,5:0,6:0,unknown:0};for(let n of N){var t;let l=null===(t=(0,c.V$)(n))||void 0===t?void 0:t.hsk_level;l&&l>=1&&l<=6?e[l]+=1:e.unknown+=1}return e},[N]);async function M(){q(null);try{let t=function(e){let t=new Set;for(let n of e)d.test(n)&&t.add(n);return[...t]}(m);if(0===t.length){q("No Chinese characters were found in the pasted text.");return}let n=await (0,x.FA)(t),l=new Set;for(let a of t){var e;(null===(e=n.get(a))||void 0===e?void 0:e.status)==="known"&&l.add(a)}let a=new Set(t.filter(e=>{var t;return(null===(t=n.get(e))||void 0===t?void 0:t.status)!=="study"}));k(t),y(l),_(a),g("review")}catch(e){q(e.message)}}async function P(){K(!0),q(null);try{await (0,x.dS)(m,N,j,S);let e=N.filter(e=>!j.has(e)&&S.has(e)).map(p),t=N.filter(e=>!S.has(e)).map(p),n=e=>{let t=new Map;for(let n of e)t.has(n.character)||t.set(n.character,n);return[...t.values()]};E({newKnown:n(e),queuedStudy:n(t)}),g("result");let l=await (0,x.B9)();i(l)}catch(e){q(e.message)}finally{K(!1)}}return(0,l.jsxs)("main",{className:"relative mx-auto min-h-screen max-w-5xl px-4 py-10 sm:px-6",children:[(0,l.jsx)(h.v,{}),(0,l.jsx)(r.T,{}),e?(0,l.jsx)("p",{className:"mt-6 text-center text-stone-600",children:"Loading..."}):null,e?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.k,{knownCount:n}),(0,l.jsx)(s.X,{active:"home"}),"review"===w&&N.length>0?(0,l.jsxs)("div",{className:"mx-auto mt-8 max-w-4xl",children:[(0,l.jsx)("p",{className:"mb-3 text-left text-sm text-stone-700",children:"Deselect any character you do not recognize to add to study and select unhighlighted characters you would like to move to known."}),(0,l.jsx)(b,{stats:F})]}):null,(0,l.jsxs)("section",{className:"mx-auto mt-4 max-w-4xl space-y-4",children:["input"===w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("textarea",{value:m,onChange:e=>f(e.target.value),placeholder:"Paste Chinese text here...",className:"h-60 w-full rounded-2xl border border-line bg-white p-5 text-lg leading-8 outline-none shadow-card focus:border-stone-400"}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)("button",{onClick:M,className:"rounded-xl bg-stone-800 px-5 py-2.5 text-sm text-white hover:bg-stone-700",children:"Load"})})]}):null,"review"===w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u,{text:m,selected:S,known:j,onToggle:function(e){_(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})}}),(0,l.jsxs)("p",{className:"text-right text-sm text-stone-600",children:["Selected for logging: ",B," / ",N.length]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)("button",{onClick:()=>g("input"),className:"rounded-xl border border-line px-5 py-2.5 text-sm hover:bg-white",children:"Back"}),(0,l.jsx)("button",{disabled:C,onClick:P,className:"rounded-xl bg-stone-800 px-5 py-2.5 text-sm text-white hover:bg-stone-700 disabled:opacity-60",children:C?"Logging...":"Log"})]})]}):null,"result"===w&&L?(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("p",{className:"text-xl text-stone-700",children:"Log complete."}),(0,l.jsx)("div",{className:"mx-auto max-w-4xl",children:(0,l.jsx)(b,{stats:F})}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"rounded-2xl border border-line bg-white p-4 shadow-card",children:[(0,l.jsx)("h3",{className:"mb-3 text-base font-medium",children:"New characters logged"}),(0,l.jsx)(v,{rows:L.newKnown,empty:"No new known characters in this event."})]}),(0,l.jsxs)("div",{className:"rounded-2xl border border-line bg-white p-4 shadow-card",children:[(0,l.jsx)("h3",{className:"mb-3 text-base font-medium",children:"Characters to study"}),(0,l.jsx)(v,{rows:L.queuedStudy,empty:"No study-queued characters in this event."})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)("button",{onClick:()=>g("review"),className:"rounded-xl border border-line px-5 py-2.5 text-sm hover:bg-white",children:"Back"}),(0,l.jsx)("button",{onClick:function(){f(""),g("input"),y(new Set),k([]),_(new Set),E(null),q(null)},className:"rounded-xl border border-line px-5 py-2.5 text-sm hover:bg-white",children:"Load another text"})]})]}):null,H?(0,l.jsx)("p",{className:"text-sm text-rose-700",children:H}):null]})]})]})}function v(e){let{rows:t,empty:n}=e;return 0===t.length?(0,l.jsx)("p",{className:"text-sm text-stone-500",children:n}):(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(e=>(0,l.jsx)("span",{className:"text-2xl",style:{color:(0,i.eS)(e.hsk_level)},title:e.pinyin||"No pinyin",children:e.character},e.character))})}function b(e){let{stats:t}=e,n=[{label:"HSK 1",count:t[1],color:"var(--h1)"},{label:"HSK 2",count:t[2],color:"var(--h2)"},{label:"HSK 3",count:t[3],color:"var(--h3)"},{label:"HSK 4",count:t[4],color:"var(--h4)"},{label:"HSK 5",count:t[5],color:"var(--h5)"},{label:"HSK 6",count:t[6],color:"var(--h6)"},{label:"Unknown",count:t.unknown,color:"var(--h0)"}],a=Math.max(t[1]+t[2]+t[3]+t[4]+t[5]+t[6]+t.unknown,1);return(0,l.jsx)("div",{className:"rounded-xl border border-line bg-white p-3 shadow-card",style:{"--h1":"#c41d0e","--h2":"#15803d","--h3":"#1d4ed8","--h4":"#fa6f19","--h5":"#8f7bbf","--h6":"#f74f90","--h0":"#6b7280"},children:(0,l.jsx)("div",{className:"flex flex-wrap justify-center gap-5",children:n.map(e=>{let t=e.count/a*100,n="Unknown"===e.label?m.unknown:m[Number(e.label.replace("HSK ",""))];return(0,l.jsxs)("div",{className:"flex items-center gap-2 text-xs text-stone-600",children:[(0,l.jsx)("span",{className:"inline-block h-6 w-6 rounded-full border border-stone-300",style:{background:"conic-gradient(".concat(e.color," ").concat(t,"%, #e7e5e4 ").concat(t,"% 100%)")}}),(0,l.jsxs)("span",{className:"flex flex-col leading-tight",style:{color:e.color},children:[(0,l.jsx)("span",{children:e.label}),(0,l.jsxs)("span",{children:["(",e.count,"/",n,")"]})]})]},e.label)})})})}}},function(e){e.O(0,[726,282,971,117,744],function(){return e(e.s=7697)}),_N_E=e.O()}]);