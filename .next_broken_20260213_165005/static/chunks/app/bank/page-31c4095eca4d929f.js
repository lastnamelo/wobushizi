(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[19],{4997:function(e,t,r){Promise.resolve().then(r.bind(r,7047))},7047:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var n=r(7437),a=r(2265),l=r(4560),s=r(5696),c=r(3941);function i(e){let{title:t,rows:r,emptyMessage:l,onSetKnown:i,onSetStudy:o}=e,[u,d]=(0,a.useState)(""),[h,x]=(0,a.useState)("all"),[p,m]=(0,a.useState)("frequency"),f=(0,a.useMemo)(()=>{let e=new Map;for(let a of r){var t,n;let r=e.get(a.character);if(!r){e.set(a.character,a);continue}let l=null!==(t=r.frequency)&&void 0!==t?t:Number.MAX_SAFE_INTEGER;(null!==(n=a.frequency)&&void 0!==n?n:Number.MAX_SAFE_INTEGER)<l&&e.set(a.character,{...a,alternate_characters:r.alternate_characters||a.alternate_characters,traditional_character:r.traditional_character||a.traditional_character})}let a=u.trim().normalize("NFKC").toLowerCase(),l=(0,c.q)(a),s=l.length>0&&/^[a-z]+$/.test(l);return[...e.values()].filter(e=>{var t,r,n,i,o;if("all"!==h&&(null==e.hsk_level?"unknown":String(e.hsk_level))!==h)return!1;if(!a)return!0;let u=(null!==(t=e.pinyin)&&void 0!==t?t:"").toLowerCase(),d=(0,c.U)(u),x=null!==(r=e.alternate_characters)&&void 0!==r?r:"";return s?d.some(e=>e===l):e.character.includes(a)||String(null!==(n=e.traditional_character)&&void 0!==n?n:"").includes(a)||x.includes(a)||d.some(e=>e.startsWith(l))||String(null!==(i=e.hsk_level)&&void 0!==i?i:"").includes(a)||String(null!==(o=e.frequency)&&void 0!==o?o:"").includes(a)}).sort((e,t)=>{var r,n,a,l;if("frequency"===p){let a=null!==(r=e.frequency)&&void 0!==r?r:Number.MAX_SAFE_INTEGER,l=null!==(n=t.frequency)&&void 0!==n?n:Number.MAX_SAFE_INTEGER;if(a!==l)return a-l}if("hsk"===p){let r=null!==(a=e.hsk_level)&&void 0!==a?a:99,n=null!==(l=t.hsk_level)&&void 0!==l?l:99;if(r!==n)return r-n}return e.character.localeCompare(t.character,"zh-Hans-CN")})},[r,u,p,h]);return(0,n.jsxs)("section",{className:"rounded-2xl border border-line bg-white p-4 shadow-card",children:[(0,n.jsxs)("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-3",children:[(0,n.jsx)("h2",{className:"text-lg font-medium text-stone-800",children:t}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,n.jsx)("input",{value:u,onChange:e=>d(e.target.value),placeholder:"Search char / pinyin / trad-alt",className:"rounded-lg border border-line bg-stone-50 px-3 py-1.5 text-sm outline-none focus:border-stone-400"}),(0,n.jsxs)("select",{value:h,onChange:e=>x(e.target.value),className:"rounded-lg border border-line bg-stone-50 px-3 py-1.5 text-sm outline-none focus:border-stone-400",children:[(0,n.jsx)("option",{value:"all",children:"HSK: All"}),(0,n.jsx)("option",{value:"1",children:"HSK 1"}),(0,n.jsx)("option",{value:"2",children:"HSK 2"}),(0,n.jsx)("option",{value:"3",children:"HSK 3"}),(0,n.jsx)("option",{value:"4",children:"HSK 4"}),(0,n.jsx)("option",{value:"5",children:"HSK 5"}),(0,n.jsx)("option",{value:"6",children:"HSK 6"}),(0,n.jsx)("option",{value:"unknown",children:"HSK Unknown"})]}),(0,n.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"rounded-lg border border-line bg-stone-50 px-3 py-1.5 text-sm outline-none focus:border-stone-400",children:[(0,n.jsx)("option",{value:"frequency",children:"Sort: Frequency"}),(0,n.jsx)("option",{value:"hsk",children:"Sort: HSK"}),(0,n.jsx)("option",{value:"character",children:"Sort: Character"})]})]})]}),(0,n.jsx)("div",{className:"table-scroll",children:(0,n.jsxs)("table",{className:"w-full border-collapse text-sm",children:[(0,n.jsx)("thead",{className:"sticky top-0 z-10 bg-white",children:(0,n.jsxs)("tr",{className:"text-center text-stone-500",children:[(0,n.jsx)("th",{className:"border-b border-line bg-white py-2",children:"字"}),(0,n.jsx)("th",{className:"border-b border-line bg-white py-2",children:"Pinyin"}),(0,n.jsx)("th",{className:"border-b border-line bg-white py-2",children:"Definition"}),(0,n.jsx)("th",{className:"border-b border-line bg-white py-2",children:"HSK"}),(0,n.jsx)("th",{className:"border-b border-line bg-white py-2",children:"Freq"}),(0,n.jsx)("th",{className:"border-b border-line bg-white py-2",children:"Trad / Alt"}),(0,n.jsx)("th",{className:"border-b border-line bg-white py-2",children:"Action"})]})}),(0,n.jsx)("tbody",{children:0===f.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:7,className:"py-6 text-center text-stone-500",children:l})}):f.map((e,t)=>{var r;let a=new Set;if(e.traditional_character&&a.add(e.traditional_character),e.alternate_characters)for(let t of e.alternate_characters.split("|")){let e=t.trim();e&&a.add(e)}let l=[...a].join(" / ");return(0,n.jsxs)("tr",{className:"border-b border-stone-100 text-center align-middle",children:[(0,n.jsx)("td",{className:"py-2 text-lg",children:e.character}),(0,n.jsx)("td",{className:"py-2",children:e.pinyin||"-"}),(0,n.jsx)("td",{className:"max-w-xs py-2 text-left text-xs text-stone-700",children:e.definition||"-"}),(0,n.jsx)("td",{className:"py-2",children:(()=>{var t;let r=(0,s.LU)(e.hsk_level);return(0,n.jsx)("span",{className:"inline-block rounded-full px-2 py-0.5 text-xs text-stone-900",style:{backgroundColor:(0,s.Wq)(r),color:"#111827"},children:null!==(t=e.hsk_level)&&void 0!==t?t:"-"})})()}),(0,n.jsx)("td",{className:"py-2",children:null!==(r=e.frequency)&&void 0!==r?r:"-"}),(0,n.jsx)("td",{className:"py-2",children:l||"-"}),(0,n.jsx)("td",{className:"py-2",children:(0,n.jsxs)("div",{className:"flex justify-center gap-2",children:[i?(0,n.jsx)("button",{onClick:()=>i(e.character),className:"rounded-lg border border-line px-2 py-1 text-xs text-stone-700 hover:bg-stone-100",children:"Move to known"}):null,o?(0,n.jsx)("button",{onClick:()=>o(e.character),className:"rounded-lg border border-line px-2 py-1 text-xs text-stone-700 hover:bg-stone-100",children:"Move to study"}):null]})})]},"".concat(e.character,"-").concat(e.pinyin||"","-").concat(t))})})]})})]})}var o=r(5995),u=r(4798),d=r(4807),h=r(9733),x=r(6442);function p(e){return e.map(e=>{let t=(0,x.V$)(e.character);return{character:(null==t?void 0:t.character)?String(t.character):e.character,status:e.status,traditional_character:(null==t?void 0:t.traditional_character)&&t.traditional_character!==e.character?String(t.traditional_character):"",alternate_characters:"string"==typeof(null==t?void 0:t.alternate_characters)?t.alternate_characters:"",pinyin:(null==t?void 0:t.pinyin)?String(t.pinyin):"",hsk_level:"number"==typeof(null==t?void 0:t.hsk_level)?t.hsk_level:null,frequency:"number"==typeof(null==t?void 0:t.frequency)?t.frequency:null,definition:"string"==typeof(null==t?void 0:t.definition)?t.definition:""}})}function m(){let[e,t]=(0,a.useState)(!0),[r,s]=(0,a.useState)({known:[],study:[]}),[c,x]=(0,a.useState)(0),[m,f]=(0,a.useState)(null),[y,b]=(0,a.useState)("character");(0,a.useEffect)(()=>{"study"===new URLSearchParams(window.location.search).get("tab")&&b("study")},[]),(0,a.useEffect)(()=>{(async()=>{await (0,h.if)();let[e,r,n]=await Promise.all([(0,h.eJ)("known"),(0,h.eJ)("study"),(0,h.B9)()]);s({known:p(e),study:p(r)}),x(n),t(!1)})().catch(e=>{f(e.message),t(!1)})},[]);let v=(0,a.useMemo)(()=>"character"===y?r.known:r.study,[y,r]);async function g(e,t){await (0,h.m$)(e,t),s(r=>{let n="known"===t?"study":"known",a="known"===t?"known":"study",l=r[n].find(t=>t.character===e),s=null!=l?l:p([{user_id:"local-user",character:e,status:t,last_seen_at:null}])[0];return{known:"known"===a?[...r.known.filter(t=>t.character!==e),{...s,status:"known"}]:r.known.filter(t=>t.character!==e),study:"study"===a?[...r.study.filter(t=>t.character!==e),{...s,status:"study"}]:r.study.filter(t=>t.character!==e)}}),x(await (0,h.B9)())}return(0,n.jsxs)("main",{className:"relative mx-auto min-h-screen max-w-6xl px-4 py-10 sm:px-6",children:[(0,n.jsx)(d.v,{}),(0,n.jsx)(o.T,{}),(0,n.jsx)(u.k,{knownCount:c}),(0,n.jsx)(l.X,{active:y,onSelectBankTab:e=>{b(e),window.history.replaceState(null,"","/bank?tab=".concat(e))}}),e?(0,n.jsx)("p",{className:"mt-6 text-center text-stone-600",children:"Loading..."}):null,e?null:(0,n.jsxs)("section",{className:"mt-6 text-center",children:[(0,n.jsx)(i,{title:"character"===y?"Character Bank (Known)":"Study Bank",rows:v,emptyMessage:"character"===y?"No known characters yet.":"Study queue is empty.",onSetKnown:"study"===y?e=>g(e,"known"):void 0,onSetStudy:"character"===y?e=>g(e,"study"):void 0}),m?(0,n.jsx)("p",{className:"mt-3 text-sm text-rose-700",children:m}):null]})]})}},3941:function(e,t,r){"use strict";r.d(t,{U:function(){return s},q:function(){return l}});let n={ā:"a",á:"a",ǎ:"a",à:"a",Ā:"a",Á:"a",Ǎ:"a",À:"a",ē:"e",é:"e",ě:"e",è:"e",Ē:"e",É:"e",Ě:"e",È:"e",ī:"i",í:"i",ǐ:"i",ì:"i",Ī:"i",Í:"i",Ǐ:"i",Ì:"i",ō:"o",ó:"o",ǒ:"o",ò:"o",Ō:"o",Ó:"o",Ǒ:"o",Ò:"o",ū:"u",ú:"u",ǔ:"u",ù:"u",Ū:"u",Ú:"u",Ǔ:"u",Ù:"u",ü:"u",ǖ:"u",ǘ:"u",ǚ:"u",ǜ:"u",Ü:"u",Ǖ:"u",Ǘ:"u",Ǚ:"u",Ǜ:"u",ê:"e",Ê:"e"};function a(e){let t="";for(let a of e){var r;t+=null!==(r=n[a])&&void 0!==r?r:a}return t}function l(e){return a(e.normalize("NFKC")).normalize("NFD").replace(RegExp("\\p{Diacritic}","gu"),"").replace(/ü/g,"u").replace(/Ü/g,"u").toLowerCase().replace(/[0-9]/g,"").replace(/[^a-z]/g,"")}function s(e){return a(e.normalize("NFKC")).normalize("NFD").replace(RegExp("\\p{Diacritic}","gu"),"").replace(/ü/g,"u").replace(/Ü/g,"u").toLowerCase().replace(/[0-9]/g," ").split(/[^a-z]+/).map(e=>e.trim()).filter(Boolean)}}},function(e){e.O(0,[726,282,971,117,744],function(){return e(e.s=4997)}),_N_E=e.O()}]);